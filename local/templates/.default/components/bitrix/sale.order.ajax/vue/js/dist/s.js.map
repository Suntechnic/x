{"version":3,"file":"s.js","sources":["../src/order.js"],"sourcesContent":["import './order.css';\n\nimport 'x.vue.components.ui';\nlet PhoneInput = BX.X.Vue.Components.PhoneInput;\nlet Selector = BX.X.Vue.Components.Selector;\n\nimport 'x.izi'; let iziToast = BX.X.iziToast;\nimport { Currency } from 'currency';\n\nimport 'app.vue.components.basket.minimal'; let BasketMinimal = BX.App.Vue.Components.BasketMinimal;\nimport 'app.vue.components.basket.side'; let BasketSide = BX.App.Vue.Components.BasketSide;\n\nconsole.log(BasketSide);\n\nexport const Order = {\n    components: {\n        BasketMinimal: BasketMinimal,\n        BasketSide: BasketSide,\n        PhoneInput: PhoneInput,\n        Selector: Selector\n    },\n    inject: ['initdata','dictionaries'],\n    data() {\n        return {\n            // bx параметры\n            hashBasket: '',\n            arResult: {},\n\n            // счётчик обмена\n            exchange: 0,\n\n            // форма \n            form: {\n                ORDER_DESCRIPTION: '',\n                DELIVERY: '',\n                BUYER_STORE: '',\n                PAYSYSTEM: '',\n                properties: {\n\n                }\n            },\n\n            errors: {\n                ORDER_DESCRIPTION: '',\n                DELIVERY: '',\n                PAYSYSTEM: '',\n                properties: {\n\n                }\n            },\n\n            state: {\n                step: 2,\n                lang: false\n            },\n\n            reflection: {\n                updateData: 0,\n            },\n\n            dictionary: {},\n\n            agreement: false,\n\n            // карта свойств\n            // объект condition содержит два ключа - key и val\n            // если в пользовательском свойстве значение ключа с именем key равно val\n            // то данное свойство будет замаплено:\n            // - в form оно будет иметь имя fieldname\n            // - кроме того оно не будет выводится итератором свойств\n            // это необходимо для того, чтобы придать определенным свойствам нужно положение и вид в форме\n            // и связать их с данными по независимому от настроек битрикс ключу\n            map: [\n                {\n                    condition: {\n                        key: 'IS_LOCATION',\n                        val: 'Y'\n                    },\n                    fieldname: 'LOCATION'\n                },\n                {\n                    condition: {\n                        key: 'IS_PHONE',\n                        val: 'Y'\n                    },\n                    fieldname: 'PHONE'\n                },\n                {\n                    condition: {\n                        key: 'IS_EMAIL',\n                        val: 'Y'\n                    },\n                    fieldname: 'EMAIL'\n                },\n                {\n                    condition: {\n                        key: 'CODE',\n                        val: 'NAME'\n                    },\n                    fieldname: 'NAME'\n                },\n                {\n                    condition: {\n                        key: 'IS_PAYER',\n                        val: 'Y'\n                    },\n                    fieldname: 'LASTNAME'\n                },\n                {\n                    condition: {\n                        key: 'IS_ZIP',\n                        val: 'Y'\n                    },\n                    fieldname: 'ZIP'\n                },\n                {\n                    condition: {\n                        key: 'CODE',\n                        val: 'CITY'\n                    },\n                    fieldname: 'CITY'\n                },\n                {\n                    condition: {\n                        key: 'IS_ADDRESS',\n                        val: 'Y'\n                    },\n                    fieldname: 'ADDRESS'\n                },\n                {\n                    condition: {\n                        key: 'CODE',\n                        val: 'DESCRIPTION'\n                    },\n                    fieldname: 'DESCRIPTION'\n                }\n            ]\n        }\n    },\n    computed: {\n\n\n        basketEmpty () {\n            return false;\n            return !(this.$store.state.basket?.items?.length);\n        },\n\n\n\n        // реорганизация\n        properties() { // список свойств - изменяется при апдейте arResult, в т.ч. \n                        // в процесс периодических изменений\n            let properties = [];\n\n            if (this.arResult?.ORDER_PROP?.properties) {\n                properties = JSON.parse(JSON.stringify(this.arResult.ORDER_PROP.properties));\n\n                for (let i in properties) {\n                    let property = properties[i];\n\n                    property.SENDNAME = 'ORDER_PROP_' + property.ID\n                    property.MAPED = false;\n                    for (let i in this.map) {\n                        let maping = this.map[i];\n                        if (property[maping.condition.key] == maping.condition.val) {\n                            property.FIELDNAME = maping.fieldname;\n                            property.MAPED = true;\n                            break;\n                        }\n                    }\n                    if (!property.MAPED) property.FIELDNAME = property.SENDNAME\n\n                }\n            }\n\n\n            return properties;\n        },\n        propertiesUnmaped() {\n            let propertiesUnmaped = [];\n\n            for (let i in this.properties) {\n                let property = this.properties[i];\n                if (!property.MAPED) propertiesUnmaped.push(property);\n            }\n\n            return propertiesUnmaped;\n        },\n    \n\n\n\n        locations() { // список местоположений\n\n            let locations = [];\n\n            if (this.arResult?.LOCATION) {\n                //locations = JSON.parse(JSON.stringify(this.arResult.LOCATION));\n                Object.entries(this.arResult.LOCATION).forEach(([key, value]) => {\n                    locations.push({ code: value, title: key })\n                })\n            }\n\n            return locations;\n        },\n        paysystems() { // список платежных систем\n\n            let paysystems = {};\n\n            if (this.arResult?.PAY_SYSTEM) {\n                paysystems = JSON.parse(JSON.stringify(this.arResult.PAY_SYSTEM));\n            }\n\n\n            return paysystems;\n        },\n        paysystem() { // выбранная система\n            for (let i in this.paysystems) {\n                if (this.paysystems[i].CHECKED == 'Y') {\n                    return this.paysystems[i];\n                }\n            }\n        },\n        deliveries() { // список доставок\n\n            let deliveries = {};\n\n            if (this.arResult?.DELIVERY) {\n                deliveries = JSON.parse(JSON.stringify(this.arResult.DELIVERY));\n                // преобразования\n                for (let id in deliveries) {\n                    deliveries[id].PRICE_FORMATED = Currency.currencyFormat(\n                        deliveries[id].PRICE,\n                        deliveries[id].CURRENCY,\n                        true\n                    );\n                }\n            }\n\n            return deliveries;\n        },\n        delivery() { // выбранная доставка берется из доставки отмеченной Y, которая обновляется при обновлении this.arResult\n            for (let id in this.deliveries) {\n                if (this.deliveries[id].CHECKED == 'Y') {\n                    return this.deliveries[id];\n                }\n            }\n        },\n        deliveryStores() { // выбранная доставка\n            let stores = false;\n            if (this.delivery?.STORE?.length) {\n                stores = [];\n                for (let i in this.delivery.STORE) {\n                    let StoreId = this.delivery.STORE[i];\n                    stores.push(JSON.parse(JSON.stringify(this.arResult.STORE_LIST[StoreId])));\n\n                }\n            }\n            return stores;\n        },\n        store() {\n            if (this.form.BUYER_STORE) {\n                return this.arResult.STORE_LIST[this.form.BUYER_STORE]\n            }\n            return false;\n        },\n        displayedDeliveryAddress() {\n            if (this.store) {\n                return this.store.ADDRESS;\n            } else {\n                let addressTokens = [];\n                for (let i in this.propertiesUserPropsDelivery) {\n                    let val = this.form.properties[this.propertiesUserPropsDelivery[i].FIELDNAME];\n                    if (val) addressTokens.push(val);\n\n                }\n                return addressTokens.join(', ');\n            }\n        },\n\n        total() {\n\n            let total = {};\n            if (this.arResult?.TOTAL) {\n                total = JSON.parse(JSON.stringify(this.arResult.TOTAL));\n\n            } else {\n                total = {\n                    BASKET_POSITIONS: 0,\n                    ORDER_TOTAL_PRICE: 0\n                };\n            }\n            // преобразования\n            if (typeof total.ORDER_TOTAL_PRICE != 'undefined') {\n                total.ORDER_TOTAL_PRICE_FORMATED = Currency.currencyFormat(total.ORDER_TOTAL_PRICE, 'USD', true);\n            } else {\n                total.ORDER_TOTAL_PRICE_FORMATED = '';\n            }\n\n\n            return total;\n        },\n\n        // сопутствующие расходы\n        conex() {\n            let conex = [];\n\n            conex.push({\n                'title': 'Shipping',\n                'price': this.total.DELIVERY_PRICE,\n                'priceformated': Currency.currencyFormat(this.total.DELIVERY_PRICE, 'USD', true) // this.total.DELIVERY_PRICE_FORMATED,\n            });\n\n            return conex;\n        },\n\n    },\n    watch: {\n        exchange: {\n            handler(val, oval) {\n                if (val && !oval) {\n                    \n                } else if (!val && oval) {\n                    \n                }\n            }\n        },\n        ////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n        // вотчеры изменяющие errors\n        form: {\n            // следим за форм, и если текущее значение свойства, отличается от ошиюбочного - гасим ошибку\n            handler(form) {\n                if (this.properties) {\n                    for (let i in this.properties) {\n                        let property = this.properties[i];\n                        if (typeof this.errors.properties[property.FIELDNAME] != 'undefined') {\n                            // в этом свойстве есть ошибка\n                            if (this.errors.properties[property.FIELDNAME].value\n                                != this.form.properties[property.FIELDNAME]\n                            ) delete this.errors.properties[property.FIELDNAME]; // гасим ее\n                        }\n                    }\n                }\n            },\n            deep: true\n        },\n        // вотчеры изменяющие errors\n        ////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n        ////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n        // вотчеры изменяющие form\n        // наблюдает за списком свойств и поддерживает актуальность form.properties\n        properties: {\n            // наблюдаемое свойство меняется при апдейте arResult и изменяет\n            handler(properties) {\n                if (properties) {\n                    for (let i in this.properties) {\n                        let property = this.properties[i];\n                        if (this.form.properties[property.FIELDNAME] != property.VALUE[0]) {\n                            //console.log(property.FIELDNAME, this.form.properties[property.FIELDNAME], property.VALUE[0]);\n                            if (property.VALUE[0] && property.VALUE[0] != 'undefined') {\n                                this.form.properties[property.FIELDNAME] = property.VALUE[0];\n                            } else {\n                                this.form.properties[property.FIELDNAME] = '';\n                            }\n\n                        }\n                    }\n                }\n            },\n            deep: true\n        },\n        paysystem: {\n            handler(val, oval) {\n                if (val && this.form.PAYSYSTEM != val.ID) {\n                    console.log('устанавливаем PAYSYSTEM');\n                    this.form.PAYSYSTEM = val.ID\n                }\n            },\n            deep: true\n        },\n        delivery: {\n            handler(val, oval) {\n                if (val && this.form.DELIVERY != val.ID) {\n                    console.log('устанавливаем DELIVERY');\n                    this.form.DELIVERY = val.ID\n                }\n            },\n            deep: true\n        },\n        store: {\n            handler(val, oval) {\n                if (val && this.form.BUYER_STORE != val.ID) {\n                    this.form.BUYER_STORE = val.ID\n                }\n            },\n            deep: true\n        },\n        // вотчеры изменяющие form\n        ////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n    },\n    created() {\n        // переносим инициализационные данные\n        this.hashBasket = this.initdata.hashBasket;\n        this.arResult = this.initdata.arResult;\n\n        // загружаем в form значения из arResult\n        this.reloadResult();\n\n    },\n    mounted() {\n        // запускаем обновление данных,\n        // при обновлении DELIVERY, PAYSYSTEM и LOCATION\n        this.$watch('form.DELIVERY', function (val, oval) {\n            console.log('form.DELIVERY',val, oval);\n            if (val != oval) this.updateData();\n        });\n        this.$watch('form.PAYSYSTEM', function (val, oval) {\n            console.log('form.PAYSYSTEM',val, oval);\n            if (val != oval) this.updateData();\n        });\n        this.$watch('form.properties.LOCATION', function (val, oval) {\n            console.log('form.properties.LOCATION',val, oval);\n            if (typeof val == 'string' && val != oval) this.updateData();\n        });\n\n    },\n    methods: {\n        $_getQueryData() {\n            return {\n                'sessid': BX.bitrix_sessid(),\n                'site_id': BX.message('SITE_ID'),\n                'via_ajax': 'Y',\n                'signedParamsString': this.initdata.signedParamsString,\n            };\n        },\n        $_getFormData(full) {\n            full = full || false;\n\n            let order = {\n                'location_type': 'code' // костыль локация - без него не работает\n            }\n\n            // свойства заказа\n            for (let i in this.properties) {\n                let property = this.properties[i];\n                if (full || property.VALUE[0] != this.form.properties[property.FIELDNAME]) {\n                    order[property.SENDNAME] = this.form.properties[property.FIELDNAME];\n                }\n            }\n\n            // доставка\n            if (full || this.form.DELIVERY != this.delivery.ID) { // добавляем только если есть смысл\n                for (let id in this.deliveries) {\n                    let delivery = this.deliveries[id];\n                    if (delivery.ID == this.form.DELIVERY) {\n                        order[delivery.FIELD_NAME] = this.form.DELIVERY;\n                        break;\n                    }\n                }\n            }\n\n            // платежная система\n            if (full || this.form.PAYSYSTEM != this.paysystem.ID) { // добавляем только если есть смысл\n                order.PAY_SYSTEM_ID = this.form.PAYSYSTEM;\n            }\n\n            // комментарий\n            if (this.form.ORDER_DESCRIPTION) {\n                order.ORDER_DESCRIPTION = this.form.ORDER_DESCRIPTION;\n            }\n\n\n            return order;\n        },\n        basketchange(hash) {\n\n            if (this.hashBasket != hash) { // новый хэш\n                this.updateData();\n                this.hashBasket = hash; // запоминаем что для этой корзины мы уже запросили данные\n            } // else - мы уже знаем об этой корзине\n        },\n\n        // изменяем данные из резалт\n        // TODO: перевести сюда доставки и оплаты\n        reloadResult() {\n            if (this.arResult) {\n                if (this.arResult.BUYER_STORE) {\n                    this.form.BUYER_STORE = this.arResult.BUYER_STORE;\n                }\n            }\n        },\n\n        updateData() {\n\n\n            console.log('updateData?');\n            let vm = this;\n\n            if (this.basketEmpty) {\n                // сбросим данные\n                vm.arResult = {};\n            } else {\n                console.log('------------------------------------ update ------------------------------------');\n\n                vm.reflection.updateData = vm.reflection.updateData+1;\n                setTimeout(()=>{vm.reflection.updateData = vm.reflection.updateData-1;},8000)\n                if (vm.reflection.updateData > 8) {\n                    console.error('update recursion');\n                    return; \n                }\n\n                vm.exchange = vm.exchange + 1;\n\n                let sendData = this.$_getQueryData(true);\n                sendData.action = 'refreshOrderAjax';\n                sendData.order = this.$_getFormData(true);\n\n                BX.ajax(\n                    {\n                        url: this.initdata.ajaxUrl,\n                        method: 'POST',\n                        dataType: 'json',\n                        data: sendData,\n                        onsuccess: function (result) {\n\n                            console.log(result);\n\n                            if (result.error) {\n                                iziToast.error({\n                                    timeout: 6000,\n                                    title: 'Что-то пошло не так',\n                                    message: 'попробуйте обновить страницу'\n                                });\n                            } else if (result.order) {\n                                // обновляем значения в arResult\n                                for (let k in result.order) { // на случай если придут не все ключи\n                                    vm.arResult[k] = result.order[k];\n                                }\n                                vm.reloadResult(); // и запускаем загрузку из них\n                            } else {\n                                iziToast.error({\n                                    timeout: 6000,\n                                    title: 'Что-то пошло cовсем не так',\n                                    message: 'попробуйте обновить страницу'\n                                });\n                            }\n\n                            if (vm.exchange > 0) vm.exchange = vm.exchange - 1;\n                            BX.onCustomEvent('x.vue.loader:initVue'); // если есть компоненты внутри формы\n\n                        },\n                        onfailure: function () {\n                            iziToast.error({\n                                timeout: 6000,\n                                title: 'Ошибка',\n                                message: 'проблемы на сервере'\n                            });\n                            if (vm.exchange > 0) vm.exchange = vm.exchange - 1;\n                        },\n                    }\n                );\n            }\n        },\n        save() {\n\n            let vm = this;\n\n            // if (!vm.agreement) {\n\n            //     iziToast.warning({\n            //         timeout: 4000,\n            //         //title: title, \n            //         message: 'Вы должны согласится с условиями использования сайта'\n            //     });\n            //     return;\n            // }\n\n            vm.exchange = vm.exchange + 1;\n\n            let sendData = this.$_getQueryData(true);\n            sendData.action = 'saveOrderAjax';\n            Object.assign(sendData, this.$_getFormData(true));\n\n            BX.ajax(\n                {\n                    url: this.initdata.ajaxUrl,\n                    method: 'POST',\n                    dataType: 'json',\n                    data: sendData,\n                    onsuccess: function (result) {\n                        console.log(result);\n                        if (result.order) {\n                            let order = result.order;\n                            if (order.ERROR) {\n                                for (let CLASS in order.ERROR) {\n                                    let errors = order.ERROR[CLASS]\n                                    let title = '';\n                                    let advice = '';\n\n                                    if (CLASS == 'AUTH') {\n                                        title = 'Ошибка регистрации';\n                                    } else if (CLASS == 'PROPERTY') {\n                                        title = 'Ошибка оформления заказа';\n                                        advice = 'Заполните обязательные поля';\n                                    } else {\n                                        title = 'Ошибка';\n                                    }\n\n                                    for (let i in errors) {\n                                        let errorMessage = errors[i];\n                                        setTimeout(() => {\n                                            iziToast.error({\n                                                timeout: 4000,\n                                                title: title,\n                                                message: errorMessage + '<br>' + advice\n                                            });\n                                        }, i * 1000);\n                                    }\n                                }\n                            } else if (order.ID && order.REDIRECT_URL) {\n                                //console.log('OnOrderComplete', {id: order.ID});\n                                BX.onCustomEvent('OnOrderComplete', { id: order.ID });\n                                iziToast.success({\n                                    timeout: 4000,\n                                    //title: title, \n                                    message: 'Заказ ' + order.ID + ' оформлен'\n                                });\n                                location.href = order.REDIRECT_URL;\n                            } else {\n                                iziToast.error({\n                                    timeout: 6000,\n                                    title: 'Ошибка',\n                                    message: 'Похоже произошла непредвиденная ошибка'\n                                });\n                            }\n                        }\n                        if (vm.exchange > 0) vm.exchange = vm.exchange - 1;\n                    },\n                    onfailure: function () {\n                        iziToast.error({\n                            timeout: 6000,\n                            title: 'Ошибка',\n                            message: 'Что-то пошло совсем не так'\n                        });\n                        if (vm.exchange > 0) vm.exchange = vm.exchange - 1;\n                    },\n                }\n            );\n        },\n        $_validate(lstProps) {\n            //console.log('ВАЛИДАЦИЯ',JSON.stringify(lstProps));\n            let result = true;\n            for (let i in lstProps) {\n                let property = lstProps[i];\n                if (property.REQUIRED == 'Y' && !this.form.properties[property.FIELDNAME]) {\n                    this.errors.properties[property.FIELDNAME] = {\n                        value: this.form.properties[property.FIELDNAME],\n                        error: 'Это поле обязательно для заполнения.'\n                    }\n                    result = false;\n                }\n            }\n            return result;\n        }\n    },\n    template: /*vue-html*/`\n    <div class=\"container container--type-5\">\n        <div class=\"row\">\n\n            <div class=\"col-lg\">\n\n                <slot name=\"go2cart\"></slot>\n                \n\n                <div class=\"d-md-none d-block mb-4\">\n                    <BasketMinimal\n                            v-bind:total=\"total\"\n                            v-bind:conex=\"conex\"\n                            v-on:basketchange=\"basketchange\"\n                        />\n                </div>\n\n                <slot name=\"expresscheckout\"></slot>\n                \n                <div class=\"checkout-or\">\n                    <span>OR</span>\n                </div>\n\n                <div class=\"input-group mb-md-4 mb-5\">\n                    <div class=\"row align-items-center mb-lg-1 mb-3\">\n                        <div class=\"col\">\n                            <div class=\"input-group__title\">\n                                Contact\n                            </div>\n                        </div>\n                        <div class=\"col-auto\">\n                            <slot name=\"auth\"></slot>\n                        </div>\n                    </div>\n\n                    <label for=\"\" class=\"input\">\n                        <input type=\"email\" v-model=\"form.properties.EMAIL\">\n                        <span class=\"input__label\">\n                            Email\n                        </span>\n                    </label>\n                </div>\n                <div class=\"input-group mb-md-4 mb-5\">\n                    <div class=\"input-group__title mb-lg-1 mb-3\">\n                        Delivery\n                    </div>\n                    <div class=\"row\">\n                        <div class=\"col mb-3\">\n                            <label for=\"\" class=\"input\">\n                                <input type=\"text\" v-model=\"form.properties.NAME\">\n                                <span class=\"input__label\">\n                                    First name (optional)\n                                </span>\n                            </label>\n                        </div>\n                        <div class=\"col mb-3\">\n                            <label for=\"\" class=\"input\">\n                                <input type=\"text\" v-model=\"form.properties.LASTNAME\">\n                                <span class=\"input__label\">\n                                    Last name\n                                </span>\n                            </label>\n                        </div>\n                    </div>\n\n                    <div class=\"col-lg-12 col-6 mb-3\">\n                        <label for=\"\" class=\"input\">\n                            <input type=\"text\" v-model=\"form.properties.PHONE\">\n                            <span class=\"input__label\">\n                                Phone\n                            </span>\n                            <span class=\"input__icon\">\n                                <svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"none\"\n                                    xmlns=\"http://www.w3.org/2000/svg\">\n                                    <g clip-path=\"url(#clip0_134_896)\">\n                                        <path\n                                            d=\"M21 12C21 7.02944 16.9706 3 12 3C7.02944 3 3 7.02944 3 12C3 16.9706 7.02944 21 12 21C16.9706 21 21 16.9706 21 12Z\"\n                                            stroke=\"#9C9CA9\" stroke-width=\"1.5\" stroke-linecap=\"round\"\n                                            stroke-linejoin=\"round\" />\n                                        <path\n                                            d=\"M14 9.83002C14 8.73002 13.1 7.83002 12 7.83002C10.9 7.83002 10 8.73002 10 9.83002\"\n                                            stroke=\"#9C9CA9\" stroke-width=\"1.5\" stroke-linecap=\"round\"\n                                            stroke-linejoin=\"round\" />\n                                        <path\n                                            d=\"M12 15C11.44 15 11 15.44 11 16C11 16.56 11.44 17 12 17C12.56 17 13 16.56 13 16C13 15.44 12.56 15 12 15Z\"\n                                            fill=\"#9C9CA9\" />\n                                        <path d=\"M13.9998 9.83002C13.9998 10.63 13.5098 11.06 13.0098 11.4\"\n                                            stroke=\"#9C9CA9\" stroke-width=\"1.5\" stroke-linecap=\"round\"\n                                            stroke-linejoin=\"round\" />\n                                        <path d=\"M12 13C12 12.18 12.51 11.74 13.01 11.4\" stroke=\"#9C9CA9\"\n                                            stroke-width=\"1.5\" stroke-linecap=\"round\"\n                                            stroke-linejoin=\"round\" />\n                                        <path d=\"M12 13V13.25\" stroke=\"#9C9CA9\" stroke-width=\"1.5\"\n                                            stroke-linecap=\"round\" stroke-linejoin=\"round\" />\n                                    </g>\n                                    <defs>\n                                        <clipPath id=\"clip0_134_896\">\n                                            <rect width=\"24\" height=\"24\" fill=\"white\" />\n                                        </clipPath>\n                                    </defs>\n                                </svg>\n                            </span>\n                        </label>\n                    </div>\n\n                    <div class=\"row\">\n                        <div class=\"col mb-3\">\n                            <label for=\"\" class=\"input\">\n                                <input type=\"text\" v-model=\"form.properties.CITY\">\n                                <span class=\"input__label\">\n                                    City\n                                </span>\n                            </label>\n                        </div>\n                        <div class=\"col mb-3\">\n                            <label for=\"\" class=\"input\">\n                                <input type=\"text\" v-model=\"form.properties.ZIP\">\n                                <span class=\"input__label\">\n                                    ZIP code\n                                </span>\n                            </label>\n                        </div>\n                        \n                    </div>\n\n                    <label for=\"\" class=\"input\">\n                        <input type=\"text\" v-model=\"form.properties.ADDRESS\">\n                        <span class=\"input__label\">\n                            Address\n                        </span>\n                    </label>\n\n                </div>\n                <div class=\"input-group mb-md-4 mb-5\">\n                    <div class=\"input-group__title mb-4 mb-md-1\">\n                        Shipping method\n                    </div>\n\n\n                    <label \n                            class=\"checkout-radio\" \n                            v-for=\"delivereg in deliveries\" \n                            v-bind:key=\"'delivery_'+delivereg.ID\"\n                            v-bind:for=\"'input_delivery_'+delivereg.ID\"\n                        >\n                        <input type=\"radio\" name=\"DELIVERY_ID\" \n                                v-bind:id=\"'input_delivery_'+delivereg.ID\"\n                                v-bind:value=\"delivereg.ID\" \n                                v-model=\"form.DELIVERY\"\n                            >\n                        <span class=\"checkout-radio__label\">\n                            <div class=\"checkout-radio__input\"></div>\n                            <div class=\"checkout-radio__value\">\n                                <img v-if=\"delivereg.LOGOTIP?.SRC\" v-bind:src=\"delivereg.LOGOTIP.SRC\" alt=\"\">\n                                {{delivereg.OWN_NAME}}\n                            </div>\n                            <div class=\"checkout-radio__right\">\n                                <strong\n                                        v-if=\"delivereg?.PRICE\"\n                                        v-html=\"delivereg.PRICE_FORMATED\"\n                                    ></strong>\n                                <strong\n                                        v-else\n                                    >Free</strong>\n                            </div>\n                        </span>\n                    </label>\n                </div>\n                <div class=\"input-group mb-md-4 mb-5\">\n                    <div class=\"input-group__title\">\n                        Payment\n                    </div>\n                    <span class=\"input-group__text\">All transactions are secure and encrypted</span>\n\n\n                    <label class=\"checkout-radio\" \n                            v-for=\"paysystem in paysystems\" \n                            v-bind:key=\"'paysystem_'+paysystem.ID\"\n                            v-bind:for=\"'input_paysystem_'+paysystem.ID\"\n                        >\n                        <input type=\"radio\" name=\"PAY_SYSTEM_ID\" \n                                v-model=\"form.PAYSYSTEM\" \n                                v-bind:value=\"paysystem.ID\"\n                                v-bind:id=\"'input_paysystem_'+paysystem.ID\"\n                            >\n                        <span class=\"checkout-radio__label\">\n                            <div class=\"checkout-radio__input\">\n\n                            </div>\n                            <div class=\"checkout-radio__value\">\n                                {{paysystem.PSA_NAME}}\n                            </div>\n                            <div class=\"checkout-radio__right\" v-if=\"paysystem.PSA_LOGOTIP?.SRC\">\n                                <img v-bind:src=\"paysystem.PSA_LOGOTIP.SRC\" alt=\"\">\n                            </div>\n                        </span>\n                    </label>\n                </div>\n                \n                <div class=\"d-md-none d-block mb-5\">\n                    <div class=\"mobile-checkout\">\n                        <div class=\"row\">\n                            <div class=\"col-auto\">\n                                <div class=\"mobile-checkout__count\">\n                                    3 items\n                                </div>\n                            </div>\n                            <div class=\"col\">\n                                <div class=\"mobile-checkout__details\">\n                                    <div class=\"row mb-3\">\n                                        <div class=\"col\">\n                                            <div class=\"mobile-checkout__info\">\n                                                <div>Subtotal: <strong>$2856.00</strong></div>\n                                                <div>Shipping: Free</div>\n                                                <div>Total: <strong><span>$2856.00</span></strong></div>\n                                            </div>\n                                        </div>\n                                        <div class=\"col-auto\">\n                                            <a href=\"#\">Edit</a>\n                                        </div>\n                                    </div>\n                                    <div class=\"position-relative footer__newsleter\">\n                                        <input type=\"email\" class=\"footer__newsleter-input\"\n                                            placeholder=\"Discount code or gift card\">\n                                        <button><svg width=\"18\" height=\"14\" viewBox=\"0 0 18 14\" fill=\"none\"\n                                                xmlns=\"http://www.w3.org/2000/svg\">\n                                                <path d=\"M1.47998 6.97998H16.47\" stroke-width=\"1.5\"\n                                                    stroke-linecap=\"round\" stroke-linejoin=\"round\"></path>\n                                                <path d=\"M10.48 0.98999L16.52 6.99999L10.48 13.01\"\n                                                    stroke-width=\"1.5\" stroke-linecap=\"round\"\n                                                    stroke-linejoin=\"round\"></path>\n                                            </svg></button>\n                                    </div>\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n                <button class=\"second-button checkout-button mb-5 mb-md-0\" v-on:click=\"save\">Pay Now</button>\n\n            </div>\n            <div class=\"col-lg-auto pt-2 d-md-block d-none\">\n                <BasketSide\n                        v-bind:total=\"total\"\n                        v-bind:conex=\"conex\"\n                        v-on:basketchange=\"basketchange\"\n                    />\n            </div>\n        </div>\n\n    </div>\n\n    <div class=\"cover\" v-if=\"exchange\"></div>\n\t`\n};\n"],"names":["PhoneInput","BX","X","Vue","Components","Selector","iziToast","BasketMinimal","App","BasketSide","console","log","Order","components","inject","data","hashBasket","arResult","exchange","form","ORDER_DESCRIPTION","DELIVERY","BUYER_STORE","PAYSYSTEM","properties","errors","state","step","lang","reflection","updateData","dictionary","agreement","map","condition","key","val","fieldname","computed","basketEmpty","_this$$store$state$ba","_this$$store$state$ba2","$store","basket","items","length","_this$arResult","_this$arResult$ORDER_","ORDER_PROP","JSON","parse","stringify","i","property","SENDNAME","ID","MAPED","maping","FIELDNAME","propertiesUnmaped","push","locations","_this$arResult2","LOCATION","Object","entries","forEach","_ref","_ref2","babelHelpers","slicedToArray","value","code","title","paysystems","_this$arResult3","PAY_SYSTEM","paysystem","CHECKED","deliveries","_this$arResult4","id","PRICE_FORMATED","Currency","currencyFormat","PRICE","CURRENCY","delivery","deliveryStores","_this$delivery","_this$delivery$STORE","stores","STORE","StoreId","STORE_LIST","store","displayedDeliveryAddress","ADDRESS","addressTokens","propertiesUserPropsDelivery","join","total","_this$arResult5","TOTAL","BASKET_POSITIONS","ORDER_TOTAL_PRICE","ORDER_TOTAL_PRICE_FORMATED","conex","DELIVERY_PRICE","watch","handler","oval","deep","VALUE","created","initdata","reloadResult","mounted","$watch","methods","$_getQueryData","bitrix_sessid","message","signedParamsString","$_getFormData","full","order","FIELD_NAME","PAY_SYSTEM_ID","basketchange","hash","vm","setTimeout","error","sendData","action","ajax","url","ajaxUrl","method","dataType","onsuccess","result","timeout","k","onCustomEvent","onfailure","save","assign","ERROR","_loop","CLASS","advice","_loop2","errorMessage","REDIRECT_URL","success","location","href","$_validate","lstProps","REQUIRED","template"],"mappings":"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"}